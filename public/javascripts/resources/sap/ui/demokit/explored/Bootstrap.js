/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2016 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/ComponentContainer','sap/m/Shell','sap/ui/demokit/library','./data'],function(q,C,S,l,d){"use strict";q("#busyIndicator").css({"margin-top":"8em","text-align":"center",color:"#555555"});var B={run:function(){l._loadAllLibInfo("","_getDocuIndex",function(L,D){B._processAndStoreIndices(L,D);B._loadUi();});},_processAndStoreIndices:function(L,D){var c=["Action","Application","Container","Display","Chart","Mini Chart","Layout","List","Popup","Tile","User Input","Testing","Theming","Tutorial","Routing","Data Binding","Map"];var a=["namespace","since","category"];var f={namespace:{},since:{},category:{},formFactors:{"Independent":true,"Condensed":true,"Compact":true,"Cozy":true}};var F={"-":"Independent","S":"Condensed","SM":"Condensed, Compact","SL":"Condensed, Cozy","SML":"Condensed, Compact, Cozy","M":"Compact","ML":"Compact, Cozy","L":"Cozy"};d.entityCount=0;d.entities=[];d.filter={};d.samples={};q.each(D,function(i,h){if(!h.explored){return;}else if(!h.explored.samplesRef){q.sap.log.error("explored: cannot register lib '"+h.library+"'. missing 'explored.samplesRef'");return;}else if(Array.isArray(h.explored.samplesRef)&&h.explored.samplesRef.length!==h.explored.samplesRef.filter(function(I){return I.namespace&&I.ref;}).length){q.sap.log.error("explored: cannot register lib '"+h.library+"'. missing 'explored.samplesRef.namespace' or 'explored.samplesRef.ref' in one or more of the configured namespaces");return;}else if(!Array.isArray(h.explored.samplesRef)&&!h.explored.samplesRef.namespace){q.sap.log.error("explored: cannot register lib '"+h.library+"'. missing 'explored.samplesRef.namespace'");return;}else if(!Array.isArray(h.explored.samplesRef)&&!h.explored.samplesRef.ref){q.sap.log.error("explored: cannot register lib '"+h.library+"'. missing 'explored.samplesRef.ref'");return;}else if(!h.explored.entities){q.sap.log.error("explored: cannot register lib '"+h.library+"'. missing 'explored.entities'");return;}else{q.sap.log.info("explored: now reading lib '"+h.library+"'");}if(Array.isArray(h.explored.samplesRef)){h.explored.samplesRef.forEach(function(I){q.sap.registerModulePath(I.namespace,""+I.ref);});}else{q.sap.registerModulePath(h.explored.samplesRef.namespace,""+h.explored.samplesRef.ref);}q.each(h.explored.samples,function(i,s){if(!s.id){q.sap.log.error("explored: cannot register sample '?'. missing 'id'");}else if(!s.name){q.sap.log.error("explored: cannot register sample '"+s.id+"'. missing 'name'");}else{d.samples[s.id]=s;}});q.each(h.explored.entities,function(j,E){if(!E.id){q.sap.log.error("explored: cannot register entity '?'. missing 'id'");return;}if(h.explored.entitiesDefaults){q.each(h.explored.entitiesDefaults,function(k,v){if(!E.hasOwnProperty(k)){E[k]=v;}});}var I=E.id.lastIndexOf(".");var n=(I!==-1)?E.id.substring(0,I):E.id;E.namespace=n;if(!E.name){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing 'name'");return;}if(c.indexOf(E.category)===-1){q.sap.log.error("explored: cannot register entity '"+E.id+"'. category '"+E.category+"' is not allowed");return;}if(!E.formFactors){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing 'formFactors'");return;}if(!F[E.formFactors]){q.sap.log.error("explored: cannot register entity '"+E.id+"'. formFactors '"+E.formFactors+"' is not allowed");return;}E.formFactors=F[E.formFactors];var A=false;q.each(a,function(i,p){if(!E[p]){q.sap.log.error("explored: cannot register entity '"+E.id+"'. missing '"+p+"'");A=true;return false;}});if(A){return;}q.each(a,function(i,p){f[p][E[p]]=true;});d.entities.push(E);});});q.each(d.entities,function(n,E){var i=0,s,p;E.searchTags=E.name+" "+E.name.replace(" ","")+" "+E.category;if(E.samples&&!(E.samples instanceof Array)){E.samples=[];q.sap.log.error("explored: cannot register samples for entity '"+E.id+"'. 'samples' is not an array");return;}if(!E.samples){E.samples=[];}if(E.samplesAsSteps){if(!(E.samplesAsSteps instanceof Array)){q.sap.log.error("explored: cannot register samples for entity '"+E.id+"'. 'samplesAsSteps' is not an array");return;}p=function(N){if(N.toString().length===1){return"0"+N;}return N;};for(;i<E.samplesAsSteps.length;i++){s={"id":E.id+"."+p(i+1),"name":E.name+" - Step "+(i+1)+" - "+E.samplesAsSteps[i]};if(i>0){s.previousSampleId=E.id+"."+p(i);}if(i<E.samplesAsSteps.length-1){s.nextSampleId=E.id+"."+p(i+2);}E.samples.push(s);d.samples[s.id]=s;E.searchTags+=" "+s.name;}}else{var h=[],P;q.each(E.samples,function(j,I){var k=d.samples[I];if(!k){q.sap.log.warning("explored: cannot register sample '"+I+"' for '"+E.id+"'. not found in the available docu indizes");}else{k.previousSampleId=(P?P.id:undefined);if(P){P.nextSampleId=k.id;}P=k;h.push(k);E.searchTags+=" "+k.name;}});E.samples=h;}E.sampleCount=E.samples.length;});d.entityCount=d.entities.length;q.each(f,function(s,h){d.filter[s]=[];q.each(h,function(k,v){d.filter[s].push({id:k});});});q.sap.require("sap.ui.core.util.LibraryInfo");var b=sap.ui.require("sap/ui/core/util/LibraryInfo");var o=new b();var e={};var g=function(h){e[h.library]=h.componentInfo;};for(var i=0;i<L.length;i++){o._getLibraryInfo(L[i],g);}d.libComponentInfos=e;},_loadUi:function(){var p=q.sap.getModulePath("sap.ui.demokit.explored");new S("Shell",{title:"SAPUI5 Explored",showLogout:false,app:new C({name:'sap.ui.demokit.explored'}),homeIcon:{'phone':p+'/img/57_iPhone_Desktop_Launch.png','phone@2':p+'/img/114_iPhone-Retina_Web_Clip.png','tablet':p+'/img/72_iPad_Desktop_Launch.png','tablet@2':p+'/img/144_iPad_Retina_Web_Clip.png','favicon':p+'/img/favicon.ico','precomposed':false}}).placeAt('content');}};return B;},true);
